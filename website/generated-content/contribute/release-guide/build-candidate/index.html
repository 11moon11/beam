<!DOCTYPE html>
<!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<html lang="en">
  <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Beam Release Guide: 04 - Build Candidate</title>
  <meta name="description" content="Apache Beam is an open source, unified model and set of language-specific SDKs for defining and executing data processing workflows, and also data ingestion and integration flows, supporting Enterprise Integration Patterns (EIPs) and Domain Specific Languages (DSLs). Dataflow pipelines simplify the mechanics of large-scale batch and streaming data processing and can run on a number of runtimes like Apache Flink, Apache Spark, and Google Cloud Dataflow (a cloud service). Beam also brings DSL in different languages, allowing users to easily implement their data integration processes.
">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400" rel="stylesheet">
  <link rel="stylesheet" href="/css/site.css">
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/language-switch.js"></script>
  <script src="/js/fix-menu.js"></script>
  <script src="/js/section-nav.js"></script>
  <script src="/js/page-nav.js"></script>
  <link rel="canonical" href="https://beam.apache.org/contribute/release-guide/build-candidate/" data-proofer-ignore>
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Apache Beam" href="https://beam.apache.org/feed.xml">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-73650088-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body class="body" data-spy="scroll" data-target=".page-nav" data-offset="0">
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<nav class="header navbar navbar-fixed-top">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/" class="navbar-brand" >
        <img alt="Brand" style="height: 25px" src="/images/beam_logo_navbar.png">
      </a>
    </div>

    <div class="navbar-mask closed"></div>

    <div id="navbar" class="navbar-container closed">
      <ul class="nav navbar-nav">
        <li>
          <a href="/get-started/beam-overview/">Get Started</a>
        </li>
        <li>
          <a href="/documentation/">Documentation</a>
        </li>
        <li>
          <a href="/documentation/sdks/java/">Languages</a>
        </li>
        <li>
          <a href="/documentation/runners/capability-matrix/">RUNNERS</a>
        </li>
        <li>
          <a href="/roadmap/">Roadmap</a>
        </li>
        <li>
          <a href="/contribute/">Contribute</a>
        </li>
        <li>
          <a href="/community/contact-us/">Community</a>
        </li>
        <li><a href="/blog">Blog</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <div style="width: 300px;">
            <script>
              (function() {
                var cx = '012923275103528129024:4emlchv9wzi';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <gcse:search></gcse:search>
          </div>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><img src="https://www.apache.org/foundation/press/kit/feather_small.png" alt="Apache Logo" style="height:20px;"><span class="caret"></span></a>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a href="http://www.apache.org/">ASF Homepage</a></li>
            <li><a href="http://www.apache.org/licenses/">License</a></li>
            <li><a href="http://www.apache.org/security/">Security</a></li>
            <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
            <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
            <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a></li>
          </ul>
        </li>
        <li>
          <!--
            data-proofer-ignore disables link checking from website test automation.
            GitHub links will not resolve until the markdown source is available on the master branch.
            New pages would fail validation during development / PR test automation.
          -->
          <a href="https://github.com/apache/beam/edit/master/website/src/contribute/release-guide/4-build-candidate.md" data-proofer-ignore>
            <i class="far fa-edit fa-lg" alt="Edit on GitHub" title="Edit on GitHub"></i>
          </a>
        </li>
      </ul>
    </div>
</nav>

    <div class="clearfix container-main-content">
      <div class="section-nav closed" data-offset-top="90" data-offset-bottom="500">
        <span class="section-nav-back glyphicon glyphicon-menu-left"></span>
        <nav>
          <ul class="section-nav-list" data-section-nav>
            <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<li><span class="section-nav-list-main-title">Contribute</span></li>
<li><a href="/contribute/">Get started contributing</a></li>
<li><a href="/contribute/get-help/">Get Help</a></li>
<li>
  <span class="section-nav-list-title">Technical Docs</span>

  <ul class="section-nav-list">
    <li><a href="https://cwiki.apache.org/confluence/display/BEAM/Contribution+Testing+Guide">Testing guide</a></li>
    <li><a href="/contribute/precommit-triage-guide/">Pre-commit Slowness Triage</a></li>
    <li><a href="/contribute/ptransform-style-guide/">PTransform style guide</a></li>
    <li><a href="/contribute/runner-guide/">Runner authoring guide</a></li>
    <li><a href="/contribute/design-documents/">Design documents</a></li>
    <li><a href="/contribute/dependencies/">Dependencies guide</a></li>
    <li><a href="/contribute/feature-branches/">Feature branches</a></li>
  </ul>
</li>
<li>
  <span class="section-nav-list-title">Policies</span>
  <ul class="section-nav-list">
    <li><a href="/contribute/precommit-policies/">Pre-commit test policies</a></li>
    <li><a href="/contribute/postcommits-policies/">Post-commit test policies</a></li>
  </ul>
</li>
<li>
  <span class="section-nav-list-title">Committers</span>
  <ul class="section-nav-list">
    <li><a href="/contribute/become-a-committer/">Become a committer</a></li>
    <li><a href="/contribute/committer-guide/">Committer guide</a></li>
    <li>
      <span class="section-nav-list-title">Release guide</span>
      <ul class="section-nav-list">

        <li><a href="/contribute/release-guide/">Overview</a></li>
        <li><a href="/contribute/release-guide/prepare/">Prepare</a></li>
        <li><a href="/contribute/release-guide/create-branch/">Create Branch</a></li>
        <li><a href="/contribute/release-guide/verify-branch/">Verify Branch</a></li>
        <li><a href="/contribute/release-guide/build-candidate/">Build Candidate</a></li>
        <li><a href="/contribute/release-guide/triage-jira/">Triage JIRAs</a></li>
        <li><a href="/contribute/release-guide/prepare-docs/">Prepare Docs</a></li>
        <li><a href="/contribute/release-guide/validate-candidate/">Validate Candidate</a></li>
        <li><a href="/contribute/release-guide/finalize/">Finalize</a></li>
        <li><a href="/contribute/release-guide/post-release">Post-release</a></li>
      </ul>
    </li>
  </ul>
</li>

          </ul>
        </nav>
      </div>

      <nav class="page-nav clearfix" data-offset-top="90" data-offset-bottom="500">
        <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->



<ul class="nav">
  <li><a href="#checklist-before-proceeding">Checklist before proceeding</a></li>
  <li><a href="#build-a-release-candidate-1">Build a release candidate</a>
    <ul>
      <li><a href="#run-build_release_candidatesh-to-create-a-release-candidate">Run <code class="highlighter-rouge">build_release_candidate.sh</code> to create a release candidate</a></li>
      <li><a href="#tasks-you-need-to-do-manually">Tasks you need to do manually:</a></li>
    </ul>
  </li>
  <li><a href="#alternative-run-all-steps-manually">(Alternative) Run all steps manually</a>
    <ul>
      <li><a href="#close-the-staging-repository-on-apache-nexus">Close the staging repository on Apache Nexus</a></li>
    </ul>
  </li>
  <li><a href="#build-and-stage-python-wheels">Build and stage python wheels</a></li>
</ul>


      </nav>

      <div class="body__contained body__section-nav">
        <!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<h1 id="build-a-release-candidate">Build a release candidate</h1>

<hr />

<h2 id="checklist-before-proceeding">Checklist before proceeding</h2>

<ul>
  <li>Release Manager’s GPG key is published to <code class="highlighter-rouge">dist.apache.org</code>;</li>
  <li>Release Manager’s GPG key is configured in <code class="highlighter-rouge">git</code> configuration;</li>
  <li>Release Manager has <code class="highlighter-rouge">org.apache.beam</code> listed under <code class="highlighter-rouge">Staging Profiles</code> in Nexus;</li>
  <li>Release Manager’s Nexus User Token is configured in <code class="highlighter-rouge">settings.xml</code>;</li>
  <li>JIRA release item for the subsequent release has been created;</li>
  <li>All test failures from branch verification have associated JIRA issues;</li>
  <li>There are no release blocking JIRA issues;</li>
  <li>Release Notes in JIRA have been audited and adjusted;</li>
  <li>Combined javadoc has the appropriate contents;</li>
  <li>Release branch has been created;</li>
  <li>There are no open pull requests to release branch;</li>
  <li>Originating branch has the version information updated to the new version;</li>
  <li>Nightly snapshot is in progress (do revisit it continually);</li>
</ul>

<hr />

<h2 id="build-a-release-candidate-1">Build a release candidate</h2>

<p>The core of the release process is the build-vote-fix cycle. Each cycle produces one release candidate.
The Release Manager repeats this cycle until the community approves one release candidate, which is then finalized.</p>

<p>For this step, we recommend you using automation script to create a RC, but you still can perform all steps manually if you want.</p>

<h3 id="run-build_release_candidatesh-to-create-a-release-candidate">Run <code class="highlighter-rouge">build_release_candidate.sh</code> to create a release candidate</h3>

<ul>
  <li>
    <p>Script: <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/build_release_candidate.sh">build_release_candidate.sh</a></p>
  </li>
  <li>
    <p>Usage</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>./beam/release/src/main/scripts/build_release_candidate.sh
</code></pre>
    </div>
  </li>
  <li>
    <p>The script does the following:</p>
    <ol>
      <li>Runs gradle release to create rc tag and push source release into github repo.</li>
      <li>
        <p>Runs gradle publish to push java artifacts into Maven staging repo.</p>

        <p><strong>NOTE</strong>: In order to public staging artifacts, you need to goto the staging repo to close the staging repository on Apache Nexus. 
When prompted for a description, enter “Apache Beam, version X, release candidate Y”.</p>
      </li>
      <li>Stages source release into dist.apache.org dev <a href="https://dist.apache.org/repos/dist/dev/beam/">repo</a>;</li>
      <li>Stages, signs and hashes python binaries into dist.apache.ord dev repo python dir;</li>
      <li>Creates a PR to update beam and beam-site, changes includes:
        <ul>
          <li>Copy python doc into beam-site;</li>
          <li>Copy java doc into beam-site;</li>
          <li>Updates release version in <a href="https://github.com/apache/beam/blob/master/website/_config.yml">_config.yml</a>;</li>
        </ul>
      </li>
    </ol>
  </li>
</ul>

<h3 id="tasks-you-need-to-do-manually">Tasks you need to do manually:</h3>
<ol>
  <li>Add new release into <code class="highlighter-rouge">website/src/get-started/downloads.md</code>;</li>
  <li>Update last release download links in <code class="highlighter-rouge">website/src/get-started/downloads.md</code>;</li>
  <li>Update <code class="highlighter-rouge">website/src/.htaccess</code> to redirect to the new version;</li>
</ol>

<hr />

<h2 id="alternative-run-all-steps-manually">(Alternative) Run all steps manually</h2>

<h4 id="build-and-stage-java-artifacts-with-gradle">Build and stage Java artifacts with Gradle</h4>

<p>For all steps check what the script does:</p>

<ul>
  <li>
    <p>Set up a few environment variables to simplify the commands that follow. These identify the release candidate being built,
and the branch where you will stage files. Start with <code class="highlighter-rouge">RC_NUM</code> equal to <code class="highlighter-rouge">1</code> and increment it for each candidate;</p>
  </li>
  <li>
    <p>Make sure your git config will maintain your account;</p>
  </li>
  <li>
    <p>Use Gradle release plugin to build the release artifacts, and push code and
release tag to the origin repository (this would be the Apache Beam repo);</p>
  </li>
  <li>
    <p>Use Gradle publish plugin to stage these artifacts on the Apache Nexus repository;</p>
  </li>
  <li>
    <p>Review all staged artifacts. They should contain all relevant parts for each module,
including <code class="highlighter-rouge">pom.xml</code>, <code class="highlighter-rouge">jar</code>, <code class="highlighter-rouge">-test.jar</code>, <code class="highlighter-rouge">javadoc</code>, etc. Artifact names should follow 
<a href="https://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.apache.beam%22">the existing format</a>.</p>

    <p>Carefully review any new artifacts.</p>
  </li>
</ul>

<h4 id="stage-source-release-on-distapacheorg">Stage source release on dist.apache.org</h4>

<p><strong>Attention</strong>: Only PMC members have permissions to perform following steps.</p>

<ul>
  <li>
    <p>Copy the source release to the dev repository of <code class="highlighter-rouge">dist.apache.org</code>:</p>

    <ol>
      <li>Check out the Beam section of the <code class="highlighter-rouge">dev</code> repository on <code class="highlighter-rouge">dist.apache.org</code> via Subversion;</li>
      <li>Make a directory for the new release;</li>
      <li>Download source zip from GitHub;</li>
      <li>Create hashes and sign the source distribution;</li>
      <li>Add and commit all the files;</li>
      <li>Verify that files are <a href="https://dist.apache.org/repos/dist/dev/beam">present</a>.</li>
    </ol>
  </li>
</ul>

<h4 id="stage-python-binaries-on-distapacheorg">Stage python binaries on dist.apache.org</h4>

<ol>
  <li>Build python binaries in release branch in sdks/python dir.</li>
  <li>Create hashes and sign the binaries</li>
</ol>

<h3 id="close-the-staging-repository-on-apache-nexus">Close the staging repository on Apache Nexus</h3>

<p>Go to Nexus UI find the staging repository, hit the close button. 
When prompted for a description, enter “Apache Beam, version X, release candidate Y”.</p>

<p>If there were mistakes found, you can drop the staging repository and re-run the publication step.</p>

<hr />

<h2 id="build-and-stage-python-wheels">Build and stage python wheels</h2>

<p>There is a wrapper repo <a href="https://github.com/apache/beam-wheels">beam-wheels</a> to help build python wheels.</p>

<p>If you are interested in how it works, please refer to the <a href="https://github.com/apache/beam-wheels#structure">structure section</a>.</p>

<p>Please follow the <a href="https://github.com/apache/beam-wheels#user-guide">user guide</a> to build python wheels.</p>

<p>Once all python wheels have been staged <a href="https://dist.apache.org/repos/dist/dev/beam/">dist.apache.org</a>, 
please run <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/sign_hash_python_wheels.sh">./sign_hash_python_wheels.sh</a> to sign and hash python wheels.</p>

<hr />
<p><a class="button button--primary" href="/contribute/release-guide/triage-jira/">Next Step: Triage Blockers</a></p>

      </div>
    </div>
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<footer class="footer">
  <div class="footer__contained">
    <div class="footer__cols">
      <div class="footer__cols__col">
        <div class="footer__cols__col__logo">
          <img src="/images/beam_logo_circle.svg" class="footer__logo" alt="Beam logo">
        </div>
        <div class="footer__cols__col__logo">
          <img src="/images/apache_logo_circle.svg" class="footer__logo" alt="Apache logo">
        </div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Start</div>
        <div class="footer__cols__col__link"><a href="/get-started/beam-overview/">Overview</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-java/">Quickstart (Java)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-py/">Quickstart (Python)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-go/">Quickstart (Go)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/downloads/">Downloads</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Docs</div>
        <div class="footer__cols__col__link"><a href="/documentation/programming-guide/">Concepts</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/pipelines/design-your-pipeline/">Pipelines</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/runners/capability-matrix/">Runners</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Community</div>
        <div class="footer__cols__col__link"><a href="/contribute/">Contribute</a></div>
        <div class="footer__cols__col__link"><a href="https://projects.apache.org/committee.html?beam" target="_blank">Team<img src="/images/external-link-icon.png"
                                                                                                                                width="14" height="14"
                                                                                                                                alt="External link."></a></div>
        <div class="footer__cols__col__link"><a href="/contribute/presentation-materials/">Media</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Resources</div>
        <div class="footer__cols__col__link"><a href="/blog/">Blog</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/support/">Support</a></div>
        <div class="footer__cols__col__link"><a href="https://github.com/apache/beam">GitHub</a></div>
      </div>
    </div>
  </div>
  <div class="footer__bottom">
    &copy;
    <a href="http://www.apache.org">The Apache Software Foundation</a>
    | <a href="/privacy_policy">Privacy Policy</a>
    | <a href="/feed.xml">RSS Feed</a>
    <br><br>
    Apache Beam, Apache, Beam, the Beam logo, and the Apache feather logo are
    either registered trademarks or trademarks of The Apache Software
    Foundation. All other products or name brands are trademarks of their
    respective holders, including The Apache Software Foundation.
  </div>
</footer>

  </body>
</html>
